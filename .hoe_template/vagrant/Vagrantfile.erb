# -*- mode: ruby -*-
# vi: set ft=ruby :
<% main_dir_name = "#{File.basename(File.dirname(File.realpath(__FILE__)))}"
   hostname = main_dir_name.sub("vagrant-","")
%>
Vagrant::Config.run do |config|
  config.vm.define :<%= hostname %> do |config|
    config.vm.box = "ubuntu-precise"
    config.vm.host_name = "<%= hostname %>.local"
    config.vm.forward_port 80, 8080
    config.vm.forward_port 443, 8081
    config.vm.forward_port 22, 2021
    config.vm.share_folder "v-data", "/shared-data", "data", :create => true
    config.vm.provision :puppet, :options => ["--pluginsync", '--graph', '--graphdir /tmp/vagrant-puppet/manifests/graphs'] do |puppet|
      puppet.manifests_path = "manifests"
      puppet.manifest_file  = "init.pp"
      puppet.module_path = ["<%= Dir.home %>/.puppet/modules", "<%= Dir.home %>/puppet/modules"]
    end
  end
end
